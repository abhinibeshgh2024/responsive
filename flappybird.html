<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-select=none">
    <title>WebbJamm | Flappy Neon</title>
    <style>
        :root {
            --primary: #38bdf8;
            --secondary: #c084fc;
            --bg: #0b0f1a;
            --card: rgba(255, 255, 255, 0.03);
            --border: rgba(255, 255, 255, 0.1);
        }

        * { 
            margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif;
            -webkit-tap-highlight-color: transparent; outline: none;
        }

        body {
            min-height: 100vh;
            background: radial-gradient(circle at top right, #1e293b, #0b0f1a);
            color: #fff;
            display: flex; flex-direction: column; align-items: center;
            overflow: hidden; touch-action: none;
        }

        /* --- CONFIG MENU --- */
        nav { width: 100%; padding: 20px 0; display: flex; justify-content: center; align-items: center; }
        .logo-small { width: 140px; filter: drop-shadow(0 0 10px var(--primary)); }

        .setup-container {
            background: var(--card); border: 1px solid var(--border);
            padding: 25px; border-radius: 24px; backdrop-filter: blur(15px);
            width: 90%; max-width: 400px; text-align: center;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        }

        .setup-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 20px 0; }
        label { display: block; font-size: 10px; color: #94a3b8; text-transform: uppercase; letter-spacing: 1.5px; margin-bottom: 5px; }

        select {
            width: 100%; padding: 12px; border-radius: 12px;
            background: #1e293b; border: 1px solid var(--border); color: #fff;
        }

        .start-btn { 
            width: 100%; padding: 16px; background: var(--primary); 
            color: #000; border: none; border-radius: 14px; font-weight: 800; cursor: pointer;
        }

        .back-link {
            display: block; margin-top: 25px; color: #64748b; 
            text-decoration: none; font-size: 13px; font-weight: 600;
            transition: all 0.3s ease;
        }
        .back-link:hover { color: var(--primary); transform: translateY(-2px); }

        /* --- GAME ENGINE --- */
        #game-area {
            display: none; flex-direction: column; align-items: center; justify-content: center;
            width: 100%; height: 100vh; background: #000; position: fixed; top: 0; left: 0; z-index: 1000;
        }

        .game-nav {
            position: absolute; top: 20px; width: 90%; display: flex; justify-content: space-between; align-items: center;
        }
        .canvas-back {
            color: var(--primary); font-weight: 800; font-size: 12px; border: 1px solid var(--primary);
            padding: 8px 15px; border-radius: 50px; cursor: pointer;
        }

        .board-wrapper {
            position: relative; border: 3px solid var(--border); border-radius: 20px;
            background: #000; box-shadow: 0 0 40px rgba(56, 189, 248, 0.15);
            overflow: hidden;
        }

        canvas { display: block; cursor: pointer; }

        .score-display { font-size: 22px; font-weight: 900; color: var(--primary); }

        #overlay {
            position: absolute; inset: 0; background: rgba(11, 15, 26, 0.9);
            display: none; flex-direction: column; align-items: center; justify-content: center;
            z-index: 10; backdrop-filter: blur(10px);
        }

        .hint-text { margin-top: 20px; color: #444; font-size: 12px; }
    </style>
</head>
<body>

    <nav id="main-nav">
        <a href="webbgames.html"><img src="N-removebg-preview.png" alt="Logo" class="logo-small"></a>
    </nav>

    <div class="setup-container" id="setup">
        <h2 style="font-size: 16px; color: var(--secondary); letter-spacing: 2px;">FLAPPY CONFIG</h2>
        <div class="setup-grid">
            <div style="grid-column: span 2;">
                <label>Difficulty</label>
                <select id="game-speed">
                    <option value="2">üêå EASY</option>
                    <option value="3" selected>‚ö° PRO</option>
                    <option value="4.5">üî• LEGEND</option>
                </select>
            </div>
            <div>
                <label>Bird Color</label>
                <select id="bird-color">
                    <option value="#38bdf8">Cyan</option>
                    <option value="#c084fc">Purple</option>
                    <option value="#4ade80">Green</option>
                </select>
            </div>
            <div>
                <label>Theme</label>
                <select id="pipe-color">
                    <option value="#1e293b">Dark Slate</option>
                    <option value="#334155">Steel</option>
                </select>
            </div>
        </div>
        <button class="start-btn" onclick="startGame()">START MISSION</button>
        <a href="webbgames.html" class="back-link">‚Üê BACK TO WEBBJAMM</a>
    </div>

    <div id="game-area">
        <div class="game-nav">
            <div class="canvas-back" onclick="exitToMenu()">‚ùÆ BACK</div>
            <div class="score-display">SCORE: <span id="scoreText">0</span></div>
            <div style="width: 50px;"></div>
        </div>
        
        <div class="board-wrapper">
            <div id="overlay">
                <h1 style="color: #ef4444; font-size: 28px; margin-bottom: 10px;">CRASHED!</h1>
                <p id="finalScore" style="font-size: 18px; margin-bottom: 20px;"></p>
                <button class="start-btn" style="width: 150px;" onclick="location.reload()">RETRY</button>
            </div>
            <canvas id="flappyCanvas"></canvas>
        </div>
        <p class="hint-text">PC: SPACEBAR | MOBILE: TAP SCREEN</p>
    </div>

    <script>
        const canvas = document.getElementById("flappyCanvas");
        const ctx = canvas.getContext("2d");
        
        let bird, pipes, score, gameLoop, isPlaying = false;
        let gravity = 0.25;
        let jump = -4.5;
        let pipeSpeed, bColor;

        function startGame() {
            pipeSpeed = parseFloat(document.getElementById('game-speed').value);
            bColor = document.getElementById('bird-color').value;
            
            document.getElementById('setup').style.display = "none";
            document.getElementById('main-nav').style.display = "none";
            document.getElementById('game-area').style.display = "flex";

            canvas.width = Math.min(window.innerWidth - 40, 360);
            canvas.height = 500;

            const elem = document.documentElement;
            if (elem.requestFullscreen) elem.requestFullscreen().catch(() => {});
            
            isPlaying = true;
            initGame();
        }

        function initGame() {
            bird = { x: 50, y: 200, w: 30, h: 25, velocity: 0 };
            pipes = [];
            score = 0;
            pipes.push({ x: canvas.width, top: 150, bottom: 300 }); // Initial pipe
            gameLoop = setInterval(update, 1000/60);
        }

        function flap() {
            if(isPlaying) bird.velocity = jump;
        }

        // CONTROLS
        window.addEventListener("keydown", e => { if(e.code === "Space") flap(); });
        canvas.addEventListener("touchstart", e => { e.preventDefault(); flap(); });
        canvas.addEventListener("mousedown", flap);

        function exitToMenu() {
            location.reload();
        }

        function update() {
            // Bird Movement
            bird.velocity += gravity;
            bird.y += bird.velocity;

            // Pipe Logic
            if(pipes.length > 0 && pipes[0].x < -50) pipes.shift();
            
            if(pipes[pipes.length-1].x < canvas.width - 200) {
                let gap = 140;
                let minPipeHeight = 50;
                let top = Math.random() * (canvas.height - gap - (minPipeHeight * 2)) + minPipeHeight;
                pipes.push({ x: canvas.width, top: top, bottom: top + gap });
            }

            for(let p of pipes) {
                p.x -= pipeSpeed;

                // Collision Detection
                if(bird.x + bird.w > p.x && bird.x < p.x + 50) {
                    if(bird.y < p.top || bird.y + bird.h > p.bottom) gameOver();
                }

                // Scoring
                if(p.x + 50 < bird.x && !p.passed) {
                    p.passed = true;
                    score++;
                    document.getElementById('scoreText').innerText = score;
                }
            }

            if(bird.y + bird.h > canvas.height || bird.y < 0) gameOver();

            draw();
        }

        function draw() {
            ctx.fillStyle = "#000";
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Draw Pipes
            ctx.fillStyle = "#1e293b";
            ctx.shadowBlur = 0;
            for(let p of pipes) {
                ctx.fillRect(p.x, 0, 50, p.top);
                ctx.fillRect(p.x, p.bottom, 50, canvas.height - p.bottom);
                // Pipe Border
                ctx.strokeStyle = varColor('--border');
                ctx.strokeRect(p.x, 0, 50, p.top);
                ctx.strokeRect(p.x, p.bottom, 50, canvas.height - p.bottom);
            }

            // Draw Bird (Neon Box style)
            ctx.fillStyle = bColor;
            ctx.shadowBlur = 15;
            ctx.shadowColor = bColor;
            ctx.beginPath();
            ctx.roundRect(bird.x, bird.y, bird.w, bird.h, 5);
            ctx.fill();
            ctx.shadowBlur = 0;
        }

        function varColor(name) {
            return getComputedStyle(document.documentElement).getPropertyValue(name);
        }

        function gameOver() {
            clearInterval(gameLoop);
            isPlaying = false;
            document.getElementById('overlay').style.display = "flex";
            document.getElementById('finalScore').innerText = "SCORE: " + score;
            if (document.exitFullscreen) document.exitFullscreen().catch(() => {});
        }
    </script>
</body>
</html>
